"0","# ============================================================================= "
"0","# Simulation"
"0","# Description:  With simulated media data as ""media variables"" and "
"0","#               simulated price as a ""control variable"" I applied the neccesary"
"0","#               transfomations (adstock & shape) to the input variables with"
"0","#               various parameters to test the ability of this model to "
"0","#               discover the parameters I set"
"0","#"
"0","# Equation:     Weekly sales have the following form:"
"0","#"
"0","#               sales_wk = tau + BHill_tv_wk + BHill_online_wk + BHill_radio_wk "
"0","#                          + gamma*price_wk + e_wk"
"0","# ============================================================================= "
"0","#------------------------------------------------------------ "
"0","#"
"0","# Media Parameters"
"0","# ----------------"
"0","# Parameter | Media_tv  | Media_radio  | Media_online"
"0","#  rate         0.6         0.8            0.8"
"0","#  theta        5           3              4"
"0","#  K            0.2         0.2            0.2"
"0","#  S            1           2              2"
"0","#  B            0.8         0.6            0.3"
"0","#"
"0","# Other variables"
"0","# ----------------"
"0","# Parameter | Value   "
"0","#  L          13 "
"0","#  tau        4     "
"0","#  gamma      0.05   "
"0","#  e          normal(0,0.05^2)     "
"0","#------------------------------------------------------------ "
"0","fat_data <- lego2 %>% "
"0","  add_column(date = seq(as.Date(""2017-01-01""), length.out = 104, by = ""week"")) %>%  "
"0","  # adstocks"
"0","  tq_mutate(select = media_tv, mutate_fun = rollapply, width = L, align = ""right"","
"0","    FUN = delayed_decay,rate = 0.8, theta = 1,   "
"0","    l = seq(from = 0 , to = L-1),col_rename = ""adstk_tv"""
"0","  )%>% "
"0","  tq_mutate(select = media_radio, mutate_fun = rollapply, width = L, align = ""right"","
"0","    FUN = delayed_decay,rate = 0.8, theta = 1,   "
"0","    l = seq(from = 0 , to = L-1),col_rename = ""adstk_radio"""
"0","  )%>% "
"0","  tq_mutate(select = media_online, mutate_fun = rollapply, width = L, align = ""right"","
"0","    FUN = delayed_decay,rate = 0.8, theta = 1,   "
"0","    l = seq(from = 0 , to = L-1),col_rename = ""adstk_online"""
"0","  )%>% "
"0","  # Shape"
"0","  mutate(m_tv = BHill(K = 0.2, S = 1, B = 0.8,adstk_tv)) %>% "
"0","  mutate(m_rd = BHill(K = 0.2, S = 1, B = 0.8,adstk_radio)) %>% "
"0","  mutate(m_online = BHill(K = 0.2, S = 1, B = 0.8,adstk_online)) %>% "
"0","  #and errors"
"0","  mutate(e = rnorm(n = n(),mean = 0,sd = 0.05^2)) %>% "
"0","  mutate(sales = 4 + m_tv + m_rd + m_online + 0.05*price + e)"
"0","clean_data <- fat_data %>% "
"0","  select(date, sales,m_tv,m_rd,m_online,price,e) %>% "
"0","  na.omit()"
"0","clean_data"
